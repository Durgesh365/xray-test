#App.py

from flask import Flask, request, jsonify
from flask_cors import CORS
import pandas as pd
from pymongo import MongoClient
import os
from datetime import datetime
import json
import logging

app = Flask(__name__)
CORS(app)
app.secret_key = 'omnibase-secret-key-2025'

# MongoDB Configuration
client = MongoClient('mongodb://localhost:27017/')
db = client['omnibase_poc']
omnibase_collection = db['omnibase_collection']

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# CONFIGURATION - Change only this variable for different asset types
ASSET_TYPE = "turbine"  # Change to "turbine", "boiler", "solar_panel", etc.

def load_fixed_mappings():
    """Load fixed mappings from JSON file, create if doesn't exist"""
    try:        
        with open('fixed_mappings.json', 'r') as f:
            content = f.read().strip()
            return json.loads(content)
    except (json.JSONDecodeError, FileNotFoundError) as e:
        logger.warning(f"Error loading mappings: {e}, creating default")
        

def load_data_catalog():
    """Load data catalog from JSON file, create if doesn't exist"""
    try:        
        with open('data_catalog.json', 'r') as f:
            content = f.read().strip()
            return json.loads(content)
    except (json.JSONDecodeError, FileNotFoundError) as e:
        logger.warning(f"Error loading catalog: {e}, creating default")
        

def serialize_document(doc):
    """Convert MongoDB document to JSON-serializable format"""
    if isinstance(doc, dict):
        doc = doc.copy()
        if '_id' in doc:
            doc['_id'] = str(doc['_id'])
        for key, value in doc.items():
            if isinstance(value, dict):
                doc[key] = serialize_document(value)
            elif isinstance(value, list):
                doc[key] = [serialize_document(item) if isinstance(item, dict) else item for item in value]
    return doc

@app.route('/api/sites', methods=['GET'])
def get_sites():
    """Get available sites"""
    sites = [
        {"id": 1, "name": "Texas Wind Farm"},
        {"id": 2, "name": "California Solar Park"},
        {"id": 3, "name": "Arizona Power Plant"},
        {"id": 4, "name": "Nevada Energy Complex"}
    ]
    return jsonify(sites)

@app.route('/api/assets', methods=['GET'])
def get_assets():
    """Get available asset types"""
    assets = [
        {"id": 1, "name": "Turbine", "type": "turbine"},
        {"id": 2, "name": "Solar Panel", "type": "solar_panel"},
        {"id": 3, "name": "Boiler", "type": "boiler"},
        {"id": 4, "name": "Generator", "type": "generator"}
    ]
    return jsonify(assets)

@app.route('/api/analyze-excel', methods=['POST'])
def analyze_excel():
    """Analyze Excel file and return headers"""
    try:
        if 'file' not in request.files:
            return jsonify({"error": "No file uploaded"}), 400
        
        file = request.files['file']
        if file.filename == '':
            return jsonify({"error": "No file selected"}), 400
        
        if not file.filename.endswith(('.xlsx', '.xls')):
            return jsonify({"error": "Please upload an Excel file"}), 400
        
        # Read Excel headers
        df = pd.read_excel(file)
        headers = list(df.columns)
        
        # Get fixed mappings for the configured asset type
        all_mappings = load_fixed_mappings()
        mappings = all_mappings.get(ASSET_TYPE, {})
        
        return jsonify({
            "headers": headers,
            "mappings": mappings,
            "asset_type": ASSET_TYPE,
            "row_count": len(df)
        })
        
    except Exception as e:
        logger.error(f"Error analyzing Excel: {str(e)}")
        return jsonify({"error": f"Error processing file: {str(e)}"}), 500

@app.route('/api/ingest', methods=['POST'])
def ingest_data():
    """Ingest Excel data into database"""
    try:
        if 'file' not in request.files:
            return jsonify({"error": "No file uploaded"}), 400
        
        file = request.files['file']
        site_id = request.form.get('site_id')
        
        # Read Excel file
        df = pd.read_excel(file)
        
        # Get mappings for the configured asset type
        all_mappings = load_fixed_mappings()
        data_catalog = load_data_catalog()
        
        mappings = all_mappings.get(ASSET_TYPE, {})
        
        # Process data
        processed_data = []
        for index, row in df.iterrows():
            mapped_row = {
                'import_date': datetime.utcnow(),
                'asset_type': ASSET_TYPE,  # Use the configured asset type
                'site_id': site_id,
                'original_data': row.where(pd.notna(row), None).to_dict()
            }
            
            # Apply field mappings
            for source_field, target_field in mappings.items():
                if source_field in row and pd.notna(row[source_field]):
                    mapped_row[target_field] = row[source_field]
            
            processed_data.append(mapped_row)
        
        # Insert into database
        if processed_data:
            result = omnibase_collection.insert_many(processed_data)
            inserted_count = len(result.inserted_ids)
            
            return jsonify({
                "success": True,
                "message": f"Successfully ingested {inserted_count} {ASSET_TYPE} records",
                "inserted_count": inserted_count,
                "asset_type": ASSET_TYPE
            })
        else:
            return jsonify({"error": "No data found to ingest"}), 400
            
    except Exception as e:
        logger.error(f"Error during ingestion: {str(e)}")
        return jsonify({"error": f"Error ingesting data: {str(e)}"}), 500

if __name__ == '__main__':
    # Ensure JSON files exist on startup
    load_fixed_mappings()
    load_data_catalog()
    logger.info(f"Omnibase POC started with asset_type: {ASSET_TYPE}")
    app.run(debug=True, port=5000)


#2: backend\data_catalog.json
{
  "turbine": {
    "power_capacity": { "unit": "watt" },
    "height": { "unit": "inch" },
    "asset_id": { "unit": "text" },
    "name": { "unit": "text" },
    "location": { "unit": "text" },
    "status": { "unit": "text" },
    "manufacturer": { "unit": "text" },
    "installation_date": { "unit": "date" }
  },
  "solar_panel": {
    "panel_id": { "unit": "text" },
    "model_name": { "unit": "text" },
    "max_capacity": { "unit": "watt" },
    "efficiency": { "unit": "percentage" },
    "dimensions": { "unit": "millimeter" },
    "weight": { "unit": "kilogram" },
    "installation_site": { "unit": "text" },
    "manufacturer": { "unit": "text" },
    "installation_date": { "unit": "date" },
    "status": { "unit": "text" },
    "temp_coefficient": { "unit": "percentage_per_celsius" },
    "warranty_years": { "unit": "years" }
  },
  "boiler": {
    "boiler_id": { "unit": "text" },
    "model": { "unit": "text" },
    "capacity": { "unit": "liters_per_hour" },
    "pressure": { "unit": "psi" },
    "fuel_type": { "unit": "text" },
    "efficiency": { "unit": "percentage" },
    "manufacturer": { "unit": "text" },
    "installation_date": { "unit": "date" },
    "status": { "unit": "text" },
    "location": { "unit": "text" }
  }
}


#3: backend\fixed_mappings.json
{
  "turbine": {
    "ID": "asset_id",
    "TURBINE NAME": "name",
    "P_CAPACITY": "power_capacity",
    "HEIGHT": "height",
    "LOCATION": "location",
    "STATUS": "status",
    "MANUFACTURER": "manufacturer",
    "INSTALLATION_DATE": "installation_date"
  },
  "solar_panel": {
    "PANEL_ID": "panel_id",
    "MODEL_NAME": "model_name",
    "MAX_CAPACITY_W": "max_capacity",
    "EFFICIENCY_PCT": "efficiency",
    "DIMENSIONS_MM": "dimensions",
    "WEIGHT_KG": "weight",
    "INSTALLATION_SITE": "installation_site",
    "MANUFACTURER": "manufacturer",
    "INSTALL_DATE": "installation_date",
    "STATUS": "status",
    "TEMPERATURE_COEFFICIENT": "temp_coefficient",
    "WARRANTY_YEARS": "warranty_years"
  },
  "boiler": {
    "BOILER_ID": "boiler_id",
    "MODEL": "model",
    "CAPACITY_LPH": "capacity",
    "PRESSURE_PSI": "pressure",
    "FUEL_TYPE": "fuel_type",
    "EFFICIENCY": "efficiency",
    "MANUFACTURER": "manufacturer",
    "INSTALLATION_DATE": "installation_date",
    "STATUS": "status",
    "LOCATION": "location"
  }
}

#4: frontend\public\index.html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="Omnibase Excel Ingestion Platform" />
    <title>Omnibase</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>

#5: frontend\src\components\Screens.js
import React, { useState } from "react";

const Screens = () => {
  const [currentScreen, setCurrentScreen] = useState(1);
  const [selectedSite, setSelectedSite] = useState("");
  const [selectedAsset, setSelectedAsset] = useState("");
  const [selectedFile, setSelectedFile] = useState(null);
  const [mappingType, setMappingType] = useState("fixed");
  const [excelHeaders, setExcelHeaders] = useState([]);
  const [mappings, setMappings] = useState({});
  const [loading, setLoading] = useState(false);
  const [ingestResult, setIngestResult] = useState(null);

  // Mock data
  const sites = [
    { id: 1, name: "Texas Wind Farm" },
    { id: 2, name: "California Valley Site" },
    { id: 3, name: "Arizona Desert Park" },
    { id: 4, name: "Nevada Hills Complex" },
  ];

  const assets = [
    { id: 1, name: "Turbine", type: "turbine" },
    { id: 2, name: "Boiler", type: "boiler" },
    { id: 3, name: "Generator", type: "generator" },
    { id: 4, name: "Transformer", type: "transformer" },
  ];

  const handleFileUpload = async (event) => {
    const file = event.target.files[0];
    if (!file) return;

    setSelectedFile(file);
    setLoading(true);

    const formData = new FormData();
    formData.append("file", file);

    try {
      const response = await fetch("http://localhost:5000/api/analyze-excel", {
        method: "POST",
        body: formData,
      });

      const data = await response.json();

      if (response.ok) {
        setExcelHeaders(data.headers);
        setMappings(data.mappings);
        setCurrentScreen(4); // Skip to mapping display
      } else {
        alert(data.error);
      }
    } catch (error) {
      alert("Error analyzing Excel file: " + error.message);
    } finally {
      setLoading(false);
    }
  };

  const handleIngest = async () => {
    if (!selectedFile) return;

    setLoading(true);
    const formData = new FormData();
    formData.append("file", selectedFile);
    formData.append("site_id", selectedSite);
    formData.append("asset_type", selectedAsset);

    try {
      const response = await fetch("http://localhost:5000/api/ingest", {
        method: "POST",
        body: formData,
      });

      const data = await response.json();

      if (response.ok) {
        setIngestResult(data);
        setCurrentScreen(5);
      } else {
        alert(data.error);
      }
    } catch (error) {
      alert("Error ingesting data: " + error.message);
    } finally {
      setLoading(false);
    }
  };

  const renderScreen1 = () => (
    <div className="screen-container">
      <h2>1. Select Site & Asset</h2>
      <p className="screen-description">
        Choose the site and asset type for data ingestion
      </p>

      <div className="form-group">
        <label htmlFor="site">Select Site</label>
        <select
          id="site"
          className="form-control"
          value={selectedSite}
          onChange={(e) => setSelectedSite(e.target.value)}
        >
          <option value="">Choose a site...</option>
          {sites.map((site) => (
            <option key={site.id} value={site.id}>
              {site.name}
            </option>
          ))}
        </select>
      </div>

      <div className="form-group">
        <label htmlFor="asset">Select Asset Type</label>
        <select
          id="asset"
          className="form-control"
          value={selectedAsset}
          onChange={(e) => setSelectedAsset(e.target.value)}
        >
          <option value="">Choose an asset type...</option>
          {assets.map((asset) => (
            <option key={asset.id} value={asset.type}>
              {asset.name}
            </option>
          ))}
        </select>
      </div>

      <div className="navigation">
        <div></div>
        <button
          className="btn btn-primary"
          onClick={() => setCurrentScreen(2)}
          disabled={!selectedSite || !selectedAsset}
        >
          Next ‚Üí
        </button>
      </div>
    </div>
  );

  const renderScreen2 = () => (
    <div className="screen-container">
      <h2>2. Import Excel File</h2>
      <p className="screen-description">
        Upload your Excel file for data ingestion
      </p>

      <div
        className="file-upload"
        onClick={() => document.getElementById("file-input").click()}
      >
        <div className="upload-icon">üì§</div>
        <h3>Upload Excel File</h3>
        <p>Click to browse or drag and drop your .xlsx or .xls file</p>
        <input
          id="file-input"
          type="file"
          className="file-input"
          accept=".xlsx,.xls"
          onChange={handleFileUpload}
        />
        {selectedFile && (
          <p style={{ marginTop: "1rem", color: "#10b981" }}>
          Selected: {selectedFile.name}
          </p>
        )}
      </div>

      <div className="navigation">
        <button
          className="btn btn-secondary"
          onClick={() => setCurrentScreen(1)}
        >
          ‚Üê Back
        </button>
        <button
          className="btn btn-primary"
          onClick={() => setCurrentScreen(3)}
          disabled={!selectedFile}
        >
          Next ‚Üí
        </button>
      </div>
    </div>
  );

  const renderScreen3 = () => (
    <div className="screen-container">
      <h2>3. Select Mapping Type</h2>
      <p className="screen-description">
        Choose how to map Excel columns to database fields
      </p>

      <div className="form-group">
        <label>Mapping Type</label>
        <div className="radio-group">
          <label className="radio-option">
            <input
              type="radio"
              value="fixed"
              checked={mappingType === "fixed"}
              onChange={(e) => setMappingType(e.target.value)}
            />
            Fixed Mapping
          </label>
          <label className="radio-option">
            <input
              type="radio"
              value="flexible"
              checked={mappingType === "flexible"}
              onChange={(e) => setMappingType(e.target.value)}
              disabled
            />
            Flexible Mapping (Coming Soon)
          </label>
        </div>
        <p
          style={{ marginTop: "0.5rem", color: "#64748b", fontSize: "0.9rem" }}
        >
          Fixed mapping uses predefined field mappings. Flexible mapping allows
          custom field mapping.
        </p>
      </div>

      <div className="navigation">
        <button
          className="btn btn-secondary"
          onClick={() => setCurrentScreen(2)}
        >
          ‚Üê Back
        </button>
        <button className="btn btn-primary" onClick={() => setCurrentScreen(4)}>
          Next ‚Üí
        </button>
      </div>
    </div>
  );

  const renderScreen4 = () => (
    <div className="screen-container">
      <h2>4. Field Mapping Preview</h2>
      <p className="screen-description">
        Review how Excel columns will be mapped to database fields
      </p>

      <table className="mapping-table">
        <thead>
          <tr>
            <th>Excel Header</th>
            <th>Omnibase Field</th>
          </tr>
        </thead>
        <tbody>
          {excelHeaders.map((header) => (
            <tr key={header}>
              <td>{header}</td>
              <td>
                {mappings[header] ? (
                  <span style={{ color: "#10b981" }}>‚Üí {mappings[header]}</span>
                ) : (
                  <span style={{ color: "#ef4444" }}>No mapping</span>
                )}
              </td>
            </tr>
          ))}
        </tbody>
      </table>

      <div className="navigation">
        <button
          className="btn btn-secondary"
          onClick={() => setCurrentScreen(3)}
        >
          ‚Üê Back
        </button>
        <button
          className="btn btn-success"
          onClick={handleIngest}
          disabled={loading}
        >
          {loading ? "Processing..." : "üöÄ Ingest Data"}
        </button>
      </div>
    </div>
  );

  const renderScreen5 = () => (
    <div className="screen-container">
      <div className="success-screen">
        <div className="success-icon"></div>
        <h2>Data Ingestion Complete!</h2>
        <p style={{ fontSize: "1.2rem", margin: "1rem 0" }}>
          Successfully ingested <strong>{ingestResult?.inserted_count}</strong>{" "}
          records into the database.
        </p>
        <p style={{ color: "#64748b", marginBottom: "2rem" }}>
          Your data has been processed and stored in the omnibase collection.
        </p>

        <div style={{ display: "flex", gap: "1rem", justifyContent: "center" }}>
          <button
            className="btn btn-primary"
            onClick={() => {
              setCurrentScreen(1);
              setSelectedSite("");
              setSelectedAsset("");
              setSelectedFile(null);
              setIngestResult(null);
            }}
          >
            Start New Import
          </button>
        </div>
      </div>
    </div>
  );

  if (loading) {
    return (
      <div className="screen-container">
        <div className="loading">
          <h2>Processing...</h2>
          <p>Please wait while we process your data</p>
        </div>
      </div>
    );
  }

  switch (currentScreen) {
    case 1:
      return renderScreen1();
    case 2:
      return renderScreen2();
    case 3:
      return renderScreen3();
    case 4:
      return renderScreen4();
    case 5:
      return renderScreen5();
    default:
      return renderScreen1();
  }
};

export default Screens;


#6: frontend\src\App.css
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  background: #f8fafc;
  color: #334155;
}

.App {
  min-height: 100vh;
}

.app-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 2rem;
  text-align: center;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.app-header h1 {
  font-size: 2.5rem;
  margin-bottom: 0.5rem;
}

.app-header p {
  font-size: 1.1rem;
  opacity: 0.9;
}

/* Screen Container */
.screen-container {
  max-width: 800px;
  margin: 2rem auto;
  padding: 2rem;
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  border: 1px solid #e2e8f0;
}

/* Form Elements */
.form-group {
  margin-bottom: 1.5rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: #475569;
}

.form-control {
  width: 100%;
  padding: 0.75rem 1rem;
  border: 2px solid #e2e8f0;
  border-radius: 8px;
  font-size: 1rem;
  transition: border-color 0.3s ease;
}

.form-control:focus {
  outline: none;
  border-color: #667eea;
}

/* Buttons */
.btn {
  padding: 0.75rem 1.5rem;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  text-decoration: none;
  display: inline-block;
  text-align: center;
}

.btn-primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn-secondary {
  background: #64748b;
  color: white;
}

.btn-secondary:hover {
  background: #475569;
}

.btn-success {
  background: #10b981;
  color: white;
}

.btn-success:hover {
  background: #059669;
}

/* Navigation */
.navigation {
  display: flex;
  justify-content: space-between;
  margin-top: 2rem;
  padding-top: 1rem;
  border-top: 1px solid #e2e8f0;
}

/* Radio Group */
.radio-group {
  display: flex;
  gap: 2rem;
  margin-top: 0.5rem;
}

.radio-option {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
}

.radio-option input[type="radio"] {
  margin: 0;
}

/* Mapping Table */
.mapping-table {
  width: 100%;
  border-collapse: collapse;
  margin: 1rem 0;
}

.mapping-table th,
.mapping-table td {
  padding: 1rem;
  text-align: left;
  border-bottom: 1px solid #e2e8f0;
}

.mapping-table th {
  background: #f8fafc;
  font-weight: 600;
  color: #475569;
}

.mapping-table tr:hover {
  background: #f8fafc;
}

/* File Upload */
.file-upload {
  border: 2px dashed #cbd5e1;
  border-radius: 8px;
  padding: 2rem;
  text-align: center;
  transition: border-color 0.3s ease;
  cursor: pointer;
}

.file-upload:hover {
  border-color: #667eea;
}

.file-upload.dragover {
  border-color: #667eea;
  background: #f0f4ff;
}

.file-input {
  display: none;
}

.upload-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
  color: #667eea;
}

/* Success Screen */
.success-screen {
  text-align: center;
  padding: 3rem 2rem;
}

.success-icon {
  font-size: 4rem;
  color: #10b981;
  margin-bottom: 1rem;
}

/* Loading */
.loading {
  text-align: center;
  padding: 2rem;
  color: #667eea;
}


#7: frontend\src\App.js
import React from "react";
import Screens from "./components/Screens";
import "./App.css";

function App() {
  return (
    <div className="App">
      <header className="app-header">
        <h1>Omnibase</h1>
      </header>
      <main>
        <Screens />
      </main>
    </div>
  );
}

export default App;


#8: frontend\src\index.js
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

#9: frontend\package.json
{
  "name": "omnibase-frontend",
  "version": "1.0.0",
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-scripts": "5.0.1"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test",
    "eject": "react-scripts eject"
  },
  "browserslist": {
    "production": [
      ">0.2%",
      "not dead",
      "not op_mini all"
    ],
    "development": [
      "last 1 chrome version",
      "last 1 firefox version",
      "last 1 safari version"
    ]
  }
}


#10: templates\index.html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Omnibase POC - Excel Import</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 40px;
        background: #f5f5f5;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        color: #2c3e50;
        border-bottom: 2px solid #3498db;
        padding-bottom: 10px;
      }
      .upload-section {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 5px;
        margin: 20px 0;
      }
      .btn {
        background: #3498db;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
      }
      .btn:hover {
        background: #2980b9;
      }
      .mapping-info {
        background: #e8f4fd;
        padding: 15px;
        border-radius: 5px;
        margin: 15px 0;
      }
      .flash-message {
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
      }
      .flash-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Omnibase POC - Excel Import</h1>

      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div class="flash-message flash-{{ category }}">{{ message }}</div>
      {% endfor %} {% endif %} {% endwith %}

      <div class="mapping-info">
        <h3>Active Fixed Mappings ({{ mapping_count }})</h3>
        <p><strong>Asset Type:</strong> turbine (hardcoded for POC)</p>
        <ul>
          {% for source, target in mappings.items() %}
          <li><strong>{{ source }}</strong> ‚Üí <code>{{ target }}</code></li>
          {% endfor %}
        </ul>
        <p>
          <em
            >Note: Data is stored exactly as it appears in Excel - no type
            conversion applied.</em
          >
        </p>
      </div>

      <div class="upload-section">
        <h3>Upload Excel File</h3>
        <p>
          Upload an Excel file with columns that match the source fields above.
        </p>

        <form action="/upload" method="post" enctype="multipart/form-data">
          <input
            type="file"
            name="excel_file"
            accept=".xlsx,.xls"
            required
            style="margin: 15px 0; padding: 10px"
          />
          <br />
          <button type="submit" class="btn">Process with Fixed Mapping</button>
        </form>
      </div>

      <div style="margin-top: 20px">
        <a href="/data" style="color: #3498db; text-decoration: none"
          >View Imported Data</a
        >
      </div>
    </div>
  </body>
</html>


#11: templates\success.html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Import Successful - Omnibase POC</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 40px;
        background: #f5f5f5;
      }
      .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .success-header {
        background: #d4edda;
        color: #155724;
        padding: 20px;
        border-radius: 5px;
        text-align: center;
      }
      .data-preview {
        margin: 20px 0;
        background: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
      }
      .btn {
        background: #28a745;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        text-decoration: none;
        display: inline-block;
        margin: 10px 5px;
      }
      .btn-secondary {
        background: #6c757d;
      }
      pre {
        background: white;
        padding: 10px;
        border-radius: 5px;
        overflow-x: auto;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="success-header">
        <h1>Import Successful!</h1>
        <p>
          Processed <strong>{{ record_count }}</strong> records and inserted
          <strong>{{ inserted_count }}</strong> into omnibase_collection
        </p>
      </div>

      {% if sample_data %}
      <div class="data-preview">
        <h3>Sample Imported Data (First 3 records):</h3>
        {% for record in sample_data %}
        <div style="margin: 15px 0">
          <strong>Record {{ loop.index }}:</strong>
          <pre>{{ record | tojson(indent=2) }}</pre>
        </div>
        {% endfor %}
      </div>
      {% endif %}

      <div style="text-align: center; margin-top: 30px">
        <a href="/" class="btn">Import Another File</a>
        <a href="/data" class="btn btn-secondary">View All Data</a>
      </div>
    </div>
  </body>
</html>

